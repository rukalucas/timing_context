# Parallel Multi-Task Training Configuration, interleaving tasks

trainer_type: parallel
random_seed: 42

wandb:
  project: "timing_context"
  offline: false  # Set to true for offline mode

tasks:
  - task_type: instructed
    weight: 0.5  # 50% of minibatches from instructed task
    task:
      trials_per_sequence: 40

  - task_type: inferred
    weight: 0.5  # 50% of minibatches from inferred task
    task:
      trials_per_sequence: 40

model:
  hidden_size: 256
  tau: 100.0
  activation: elu

training:
  learning_rate: 1e-4
  batch_size: 128
  num_eval_samples: 128 # number of eval batches. evaluated trials = 40 * this
  log_interval: 20
  checkpoint_interval: 500
  log_dir: logs/parallel_multitask
  total_steps: 4000
